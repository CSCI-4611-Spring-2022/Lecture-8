var v=Object.defineProperty;var M=(n,e,t)=>e in n?v(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var r=(n,e,t)=>(M(n,typeof e!="symbol"?e+"":e,t),t);import{W as g,S as V,P as z,C as k,V as P,O as x,a as l,b as L,M as b,c as A,d as c,G as R,A as S,D as j,e as D,B as Y,f as u,g as y,h as C,i as E,j as f}from"./vendor.js";const W=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}};W();class G{constructor(e=1.333){r(this,"aspectRatio");r(this,"fov");r(this,"znear");r(this,"zfar");r(this,"renderer");r(this,"scene");r(this,"camera");r(this,"clock");this.aspectRatio=e,this.fov=60,this.znear=1,this.zfar=1e3,this.renderer=new g,this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.resize(),window.addEventListener("resize",()=>{this.resize()},!1),window.addEventListener("mousedown",t=>{this.onMouseDown(t)}),window.addEventListener("mouseup",t=>{this.onMouseUp(t)}),window.addEventListener("mousemove",t=>{this.onMouseMove(t)}),window.addEventListener("keydown",t=>{this.onKeyDown(t)}),window.addEventListener("keyup",t=>{this.onKeyUp(t)}),this.scene=new V,this.camera=new z(this.fov,this.aspectRatio,this.znear,this.zfar),this.clock=new k}start(){this.createScene(),this.mainLoop()}mainLoop(){this.update(this.clock.getDelta()),this.renderer.render(this.scene,this.camera),window.requestAnimationFrame(()=>this.mainLoop())}resize(){this.renderer.setSize(window.innerWidth,window.innerHeight);var e=new P;this.renderer.getViewport(e);var t=window.innerWidth/window.innerHeight;this.aspectRatio>t?this.renderer.setViewport(0,(window.innerHeight-window.innerWidth/this.aspectRatio)/2,window.innerWidth,window.innerWidth/this.aspectRatio):this.renderer.setViewport((window.innerWidth-window.innerHeight*this.aspectRatio)/2,0,window.innerHeight*this.aspectRatio,window.innerHeight)}onMouseDown(e){}onMouseUp(e){}onMouseMove(e){}onKeyDown(e){}onKeyUp(e){}}class H extends x{constructor(e,t){super();r(this,"radius");r(this,"velocity");r(this,"initialPosition");this.radius=t,this.velocity=new l,this.initialPosition=e;var o=new L(this.radius),i=new b;i.color=new A(.335,.775,.891),this.add(new c(o,i)),this.reset()}reset(){this.position.copy(this.initialPosition),this.velocity.set(0,0,0)}update(e){this.position.x+=this.velocity.x*e,this.position.y+=this.velocity.y*e,this.position.z+=this.velocity.z*e}}class I extends G{constructor(){super(1920/1080);r(this,"inputVector");r(this,"projectile");r(this,"arrow");r(this,"arrowPitch");r(this,"arrowYaw");this.inputVector=new l,this.projectile=new H(new l(0,.25,2),.5),this.arrow=new R,this.arrowPitch=20*Math.PI/180,this.arrowYaw=0}createScene(){this.camera.position.set(0,1.6,0),this.camera.lookAt(0,1.6,1),this.camera.up.set(0,1,0);var e=new S("white",.3);this.scene.add(e);var t=new j("white",.6);t.position.set(0,2,1),this.scene.add(t);var o=new D;o.side=Y,o.color.set("skyblue");var i=new c(new u(1e3,1e3,1e3),o);this.scene.add(i);var s=new y;s.color.set("green");var a=new c(new u(1e3,1,1e3),s);a.position.set(0,-.5,0),this.scene.add(a),this.scene.add(this.projectile);var h=new y;h.color.set("blue");var w=new C(.05,.05,2),d=new c(w,h);d.position.set(0,0,1),d.rotateX(90*Math.PI/180),this.arrow.add(d);var m=new E(.1,.25),p=new c(m,h);p.position.set(0,1,0),d.add(p),this.arrow.position.set(0,.25,2),this.scene.add(this.arrow)}update(e){this.arrowPitch+=90*Math.PI/180*e*this.inputVector.y,this.arrowYaw+=90*Math.PI/180*e*-this.inputVector.x;const t=90*Math.PI/180,o=75*Math.PI/180;this.arrowYaw>=t?this.arrowYaw=t:this.arrowYaw<=-t&&(this.arrowYaw=-t),this.arrowPitch>=o?this.arrowPitch=o:this.arrowPitch<=0&&(this.arrowPitch=0);var i=new f().makeRotationX(-this.arrowPitch),s=new f().makeRotationY(this.arrowYaw);this.arrow.setRotationFromMatrix(s.multiply(i));const a=1.5,h=3,w=.1;this.arrow.scale.z+=this.inputVector.z*a*e,this.arrow.scale.z>h?this.arrow.scale.z=h:this.arrow.scale.z<w&&(this.arrow.scale.z=w),this.projectile.update(e)}fire(){if(this.projectile.velocity.length()==0){var e=this.arrow.scale.z*20,t=new l(0,0,1);t.applyEuler(this.arrow.rotation),t.normalize(),this.projectile.velocity.copy(t),this.projectile.velocity.multiplyScalar(e)}}onKeyDown(e){e.key=="w"?this.inputVector.y=1:e.key=="s"?this.inputVector.y=-1:e.key=="a"?this.inputVector.x=-1:e.key=="d"?this.inputVector.x=1:e.key=="ArrowUp"?this.inputVector.z=1:e.key=="ArrowDown"?this.inputVector.z=-1:e.key==" "?this.fire():e.key=="r"&&this.projectile.reset()}onKeyUp(e){e.key=="w"&&this.inputVector.y==1?this.inputVector.y=0:e.key=="s"&&this.inputVector.y==-1?this.inputVector.y=0:e.key=="a"&&this.inputVector.x==-1?this.inputVector.x=0:e.key=="d"&&this.inputVector.x==1?this.inputVector.x=0:e.key=="ArrowUp"&&this.inputVector.z==1?this.inputVector.z=0:e.key=="ArrowDown"&&this.inputVector.z==-1&&(this.inputVector.z=0)}}var K=new I;K.start();
